import boto3

def list_s3_buckets():
    """Lists all S3 buckets in the AWS account."""
    s3 = boto3.client('s3')
    response = s3.list_buckets()
    
    print("S3 Buckets:")
    for bucket in response['Buckets']:
        print(f"- {bucket['Name']}")

def check_public_s3_buckets():
    """Checks if any S3 buckets are publicly accessible."""
    s3 = boto3.client('s3')
    response = s3.list_buckets()
    
    print("Checking for public S3 buckets:")
    for bucket in response['Buckets']:
        bucket_name = bucket['Name']
        acl = s3.get_bucket_acl(Bucket=bucket_name)
        for grant in acl['Grants']:
            if 'AllUsers' in str(grant['Grantee']) or 'AuthenticatedUsers' in str(grant['Grantee']):
                print(f"[ALERT] Publicly accessible bucket found: {bucket_name}")

if __name__ == "__main__":
    list_s3_buckets()
    check_public_s3_buckets()
